# ğŸ“Š SchÃ©mas et Architecture - INP-HB Stories

## ğŸ—„ï¸ SchÃ©ma de Base de DonnÃ©es MongoDB

### ModÃ¨le EntitÃ©/Association

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       USER          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id: ObjectId (PK)  â”‚
â”‚ name: String        â”‚
â”‚ email: String       â”‚
â”‚ password: String    â”‚
â”‚ avatar: String      â”‚
â”‚ promotion: String   â”‚
â”‚ verified: Boolean   â”‚
â”‚ createdAt: Date     â”‚
â”‚ updatedAt: Date     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 1:N (author)
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   TESTIMONIAL       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id: ObjectId (PK)  â”‚
â”‚ author: ObjectId(FK)â”‚ â”€â”€â–º USER
â”‚ content: String     â”‚
â”‚ likes: [ObjectId]   â”‚ â”€â”€â–º USER (N:N)
â”‚ likesCount: Number  â”‚
â”‚ commentsCount: Numberâ”‚
â”‚ createdAt: Date     â”‚
â”‚ updatedAt: Date     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 1:N
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      COMMENT          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id: ObjectId (PK)    â”‚
â”‚ author: ObjectId (FK) â”‚ â”€â”€â–º USER
â”‚ testimonial: ObjId(FK)â”‚ â”€â”€â–º TESTIMONIAL
â”‚ parentComment: ObjId  â”‚ â”€â”€â–º COMMENT (rÃ©cursif)
â”‚ content: String       â”‚
â”‚ likes: [ObjectId]     â”‚ â”€â”€â–º USER (N:N)
â”‚ likesCount: Number    â”‚
â”‚ repliesCount: Number  â”‚
â”‚ depth: Number         â”‚
â”‚ createdAt: Date       â”‚
â”‚ updatedAt: Date       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 1:N (rÃ©cursif)
          â”‚
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ COMMENTâ”‚ (rÃ©ponses)
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Relations

#### 1. USER â”€â”€(1:N)â”€â”€â–º TESTIMONIAL
- Un utilisateur peut crÃ©er plusieurs tÃ©moignages
- Un tÃ©moignage appartient Ã  un seul utilisateur

#### 2. USER â”€â”€(N:N)â”€â”€â–º TESTIMONIAL (Likes)
- Un utilisateur peut liker plusieurs tÃ©moignages
- Un tÃ©moignage peut Ãªtre likÃ© par plusieurs utilisateurs
- ImplÃ©mentÃ© via un tableau `likes[]` dans Testimonial

#### 3. TESTIMONIAL â”€â”€(1:N)â”€â”€â–º COMMENT
- Un tÃ©moignage peut avoir plusieurs commentaires
- Un commentaire appartient Ã  un seul tÃ©moignage

#### 4. COMMENT â”€â”€(1:N)â”€â”€â–º COMMENT (RÃ©cursif)
- Un commentaire peut avoir plusieurs rÃ©ponses
- Une rÃ©ponse est liÃ©e Ã  un commentaire parent
- Structure arborescente infinie

#### 5. USER â”€â”€(N:N)â”€â”€â–º COMMENT (Likes)
- Un utilisateur peut liker plusieurs commentaires
- Un commentaire peut Ãªtre likÃ© par plusieurs utilisateurs
- ImplÃ©mentÃ© via un tableau `likes[]` dans Comment

## ğŸ—ï¸ Architecture Full-Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLIENT (Browser)                      â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           React + TypeScript Frontend               â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚
â”‚  â”‚  â”‚Componentsâ”‚  â”‚  Hooks   â”‚  â”‚ Context  â”‚         â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚  â”‚         Services Layer               â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Axios   â”‚      â”‚ Socket.IOâ”‚     â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â”‚(HTTP API)â”‚      â”‚  Client  â”‚     â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚          â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                            â”‚
         â”‚ HTTP/REST                  â”‚ WebSocket (Socket.IO)
         â”‚                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NETWORK LAYER                             â”‚
â”‚                   (Internet/LAN)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                            â”‚
         â”‚ HTTP/REST                  â”‚ WebSocket (Socket.IO)
         â”‚                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SERVER (Node.js)                           â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚          Express.js + TypeScript Backend           â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚
â”‚  â”‚  â”‚  Routes  â”‚  â”‚Controllerâ”‚  â”‚Middlewareâ”‚         â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚  â”‚       Real-Time Layer                â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â”‚    Socket.IO Server      â”‚        â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   (WebSocket Manager)    â”‚        â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚          â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚  â”‚           Data Layer                 â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   Mongoose ODM           â”‚        â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   (Models & Schemas)     â”‚        â”‚          â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚          â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ MongoDB Driver
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE LAYER                            â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              MongoDB Database                       â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
â”‚  â”‚  â”‚ Collections  â”‚  â”‚   Indexes    â”‚               â”‚    â”‚
â”‚  â”‚  â”‚  - users     â”‚  â”‚  - author    â”‚               â”‚    â”‚
â”‚  â”‚  â”‚  - testimon. â”‚  â”‚  - createdAt â”‚               â”‚    â”‚
â”‚  â”‚  â”‚  - comments  â”‚  â”‚  - likes     â”‚               â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Flux de DonnÃ©es

### Flux API REST (CrÃ©ation de TÃ©moignage)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     1. POST /api/testimonials     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  Express â”‚
â”‚ (React) â”‚                                   â”‚  Server  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â–²                                             â”‚
     â”‚                                             â”‚
     â”‚                                        2. Validate
     â”‚                                        JWT Token
     â”‚                                             â”‚
     â”‚                                             â–¼
     â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                        â”‚  Auth   â”‚
     â”‚                                        â”‚Middlewareâ”‚
     â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                             â”‚
     â”‚                                        3. Create
     â”‚                                        Testimonial
     â”‚                                             â”‚
     â”‚                                             â–¼
     â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                        â”‚Testimonial
     â”‚                                        â”‚Controllerâ”‚
     â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                             â”‚
     â”‚                                        4. Save to
     â”‚                                        Database
     â”‚                                             â”‚
     â”‚                                             â–¼
     â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                        â”‚ MongoDB â”‚
     â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                             â”‚
     â”‚                                        5. Return
     â”‚                                        Success
     â”‚                                             â”‚
     â”‚      6. Response + Created Data             â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Flux Socket.IO (Temps RÃ©el)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client Aâ”‚                              â”‚ Client B â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                                        â”‚
     â”‚ 1. Create Comment                     â”‚
     â”‚ (via HTTP REST API)                   â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
     â”‚            â–¼                          â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
     â”‚       â”‚  Server  â”‚                   â”‚
     â”‚       â”‚(Express) â”‚                   â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                   â”‚
     â”‚             â”‚ 2. Save to DB          â”‚
     â”‚             â–¼                         â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
     â”‚       â”‚ MongoDB  â”‚                   â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                   â”‚
     â”‚             â”‚ 3. Success             â”‚
     â”‚             â–¼                         â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
     â”‚       â”‚Socket.IO â”‚                   â”‚
     â”‚       â”‚  Server  â”‚                   â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                   â”‚
     â”‚             â”‚                         â”‚
     â”‚             â”‚ 4. Emit 'comment-      â”‚
     â”‚             â”‚    created' event      â”‚
     â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚             â”‚                         â”‚
     â”‚ 5. Receive  â–¼                         â–¼ 5. Receive
     â”‚   Event  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Event
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤Socket.IO â”‚          â”‚Socket.IO â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
               â”‚  Client  â”‚          â”‚  Client  â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                      â”‚
                    â”‚ 6. Update UI         â”‚ 6. Update UI
                    â”‚   (add comment)      â”‚   (add comment)
                    â–¼                      â–¼
               Component Re-render   Component Re-render
```

## ğŸ” Flux d'Authentification JWT

```
1. INSCRIPTION/CONNEXION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Email/Password    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  Server  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ 1. Validate
                                      â”‚ 2. Hash Password
                                      â”‚ 3. Save/Compare
                                      â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚ MongoDB  â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ 4. Generate JWT
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   JWT Token + User  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  Server  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 5. Store in localStorage
     â–¼
localStorage
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
token: "eyJhb..."
user: {...}


2. REQUÃŠTES AUTHENTIFIÃ‰ES
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Request + JWT     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  Server  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   Authorization:    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              Bearer eyJhb...          â”‚
                                       â”‚ 1. Extract Token
                                       â”‚ 2. Verify JWT
                                       â”‚ 3. Decode User ID
                                       â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚   Auth   â”‚
                                 â”‚Middlewareâ”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 4. Fetch User
                                       â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ MongoDB  â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 5. Attach to req
                                       â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚Controllerâ”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ˆ Performance et Optimisation

### Index MongoDB
```javascript
// Testimonial
testimonialSchema.index({ author: 1, createdAt: -1 });
testimonialSchema.index({ likesCount: -1 });
testimonialSchema.index({ commentsCount: -1 });
testimonialSchema.index({ createdAt: -1 });

// Comment
commentSchema.index({ testimonial: 1, parentComment: 1, createdAt: -1 });
commentSchema.index({ parentComment: 1 });
commentSchema.index({ author: 1 });
```

### DÃ©normalisation
Pour optimiser les performances, certaines donnÃ©es sont dÃ©normalisÃ©es:
- `likesCount` - Compteur de likes (Ã©vite de compter le tableau)
- `commentsCount` - Compteur de commentaires
- `repliesCount` - Compteur de rÃ©ponses

### Socket.IO Rooms
Utilisation de rooms pour limiter la diffusion des Ã©vÃ©nements:
- Chaque tÃ©moignage a sa propre room
- Les clients rejoignent uniquement les rooms nÃ©cessaires
- RÃ©duit la bande passante et amÃ©liore les performances

## ğŸ§© Patterns UtilisÃ©s

### Backend
- **MVC** (Model-View-Controller)
- **Middleware Pattern** (Express.js)
- **Repository Pattern** (Mongoose Models)
- **Singleton Pattern** (Database Connection)

### Frontend
- **Component Pattern** (React)
- **Custom Hooks Pattern**
- **Context API Pattern** (State Management)
- **Service Layer Pattern** (API calls)

---

**Made with â¤ï¸ for INP-HB | ğŸ“ Excellence & Innovation**
